#!/bin/bash
# Docker Sidekiq operations script

set -e

COMMAND=${1:-""}

case $COMMAND in
    "restart")
        echo "ðŸ”„ Restarting Sidekiq..."
        docker compose restart sidekiq
        ;;
    "logs")
        echo "ðŸ“Š Showing Sidekiq logs..."
        docker compose logs -f sidekiq
        ;;
    "stats")
        echo "ðŸ“ˆ Sidekiq Stats..."
        docker compose exec sidekiq bundle exec sidekiq-cli stats
        ;;
    "cron:load")
        echo "ðŸ“… Loading cron jobs..."
        docker compose exec sidekiq bundle exec rake sidekiq:cron:load
        ;;
    "cron:list")
        echo "ðŸ“‹ Listing cron jobs..."
        docker compose exec sidekiq bundle exec rake sidekiq:cron:list
        ;;
    "clear")
        echo "ðŸ§¹ Clearing all queues..."
        docker compose exec sidekiq bundle exec rake sidekiq:clear
        ;;
    *)
        echo "ðŸ”§ Sidekiq Operations"
        echo "Usage: $0 [COMMAND]"
        echo ""
        echo "Commands:"
        echo "  restart    - Restart Sidekiq service"
        echo "  logs       - View Sidekiq logs"
        echo "  stats      - Show Sidekiq statistics"
        echo "  cron:load  - Load cron jobs from schedule"
        echo "  cron:list  - List all cron jobs"
        echo "  clear      - Clear all job queues"
        ;;
esac